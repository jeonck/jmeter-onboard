# JMeter 부하발생기 1대당 적정 유저수

JMeter 부하발생기(Slave) 1대당 적정 사용자 수(Thread)는 **"정답이 정해져 있지 않지만, 실무적인 가이드라인은 존재"**합니다.

특히 질문하신 환경이 t3.medium(2 vCPU, 4GB RAM)급 사양이라면, 하드웨어의 한계가 명확하므로 아래 기준을 참고하여 설정하는 것이 좋습니다.

## 1. t3.medium 기준 권장 사용자 수

일반적인 웹 애플리케이션 테스트를 기준으로 할 때, t3.medium 사양의 부하발생기 1대당 적정 Thread 수는 다음과 같습니다.

- **안정적인 권장치**: 200 ~ 300명
- **최대 한계치**: 500명 내외 (스크립트가 매우 가벼울 때)

## 2. 적정 인원수를 결정하는 4가지 요인

### ① 스크립트의 복잡도 (가장 중요)

- **가벼운 스크립트**: 단순 API 호출, 고정된 URL 요청 등은 500명까지도 버팁니다.
- **무거운 스크립트**: 정규표현식(Correlation)이 많거나, 응답 데이터가 크거나(수 MB), 많은 Assertion이 포함된 경우 100~200명에서도 부하발생기 자체가 느려집니다.

### ② JVM Heap Memory 설정

JMeter는 Java 기반이므로 메모리 설정이 성능을 좌우합니다.

- t3.medium(4GB)의 경우, OS 자원을 제외하고 JMeter에 2GB ~ 2.5GB 정도의 Heap 메모리를 할당하는 것이 적절합니다. (jmeter.bat 또는 jmeter.sh 파일에서 -Xms2g -Xmx2g 설정)

### ③ 리스너(Listener) 사용 여부

- GUI 모드에서 View Results Tree 같은 리스너를 켜두면 메모리를 순식간에 잡아먹어 50명도 처리하기 힘들어집니다.
- 반드시 **CLI 모드(Non-GUI)**로 실행해야 위 권장 수치를 달성할 수 있습니다.

### ④ 응답 데이터의 크기

서버에서 내려오는 응답 본문이 크면 클라이언트(부하발생기)의 네트워크 I/O와 메모리 부하가 급증합니다.

## 3. 부하발생기가 한계에 도달했는지 아는 법 (체크리스트)

테스트 도중 다음과 같은 현상이 보인다면, 사용자 수를 줄이거나 부하발생기를 늘려야(Scale-out) 합니다.

- **Response Time의 왜곡**: 서버(Scouter로 확인)는 응답을 빨리 주는데, JMeter 리포트에는 응답 시간이 길게 찍히는 경우 (부하발생기 병목).
- **JMeter 에러 발생**: 로그에 OutOfMemoryError 혹은 Standard out of memory 메시지가 보일 때.
- **CPU/메모리 고갈**: 부하발생기 자체의 CPU 사용률이 80~90%를 계속 상회할 때.

## 4. 실무적인 확장 전략 (Distributed Testing)

만약 목표 사용자 수가 1,000명이라면 어떻게 해야 할까요? t3.medium 한 대에 1,000명을 설정하는 대신, 부하발생기를 4대로 나누어 각각 250명씩 할당하는 것이 훨씬 정확한 결과를 얻을 수 있습니다.

## 💡 전문가의 팁

"처음부터 500명을 설정하지 마세요. Ultimate Thread Group을 사용하여 50명부터 시작해 10분 단위로 인원을 늘려보세요. 그러다 Scouter 상의 서버 성능은 괜찮은데 JMeter의 응답 시간이 튀기 시작하는 시점이 오면, 그 직전의 인원수가 해당 부하발생기의 '진짜 적정 인원수'입니다."