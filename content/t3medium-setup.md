# t3.medium 인스턴스 기준 부하 테스트 설정

t3.medium 인스턴스는 2 vCPU와 4GB RAM을 갖추고 있어, 프리티어(t2.micro)보다 훨씬 안정적이고 실질적인 부하 테스트가 가능합니다. 이 사양을 기준으로 실무에서 성능 테스트의 '맛'을 제대로 볼 수 있는 수치를 제안해 드립니다.

## 1. t3.medium 기준 부하 테스트 권장 설정값

이 설정은 서버가 "적당히 바쁘면서도 분석 가능한 수준"을 유지하도록 설계되었습니다.

| 설정 항목 | 권장값 | 의미 및 전략 |
|----------|--------|-------------|
| Number of Threads | 100 ~ 200 | t3.medium은 100~200명의 동시 접속자 요청을 처리할 기초 체력이 있습니다. |
| Ramp-up Period | 50 ~ 100초 | 2초당 1명씩 투입하는 전략입니다. Scouter 그래프가 계단식으로 예쁘게 그려져 분석하기 좋습니다. |
| Loop Count | Infinite (체크) | t3.medium은 메모리가 4GB라 쉽게 뻗지 않으므로, 무한으로 돌리며 5~10분간 관찰하세요. |
| Constant Timer | 500ms | 0.5초의 간격을 두어 서버의 톰캣 스레드와 DB 커넥션이 순환될 여유를 줍니다. |

## 2. t3.medium에서 주목해야 할 Scouter 지표

사양이 어느 정도 받쳐주는 서버이므로, 단순히 "살아있다/죽었다"가 아니라 **"어디가 효율적인가"**를 찾아야 합니다.

- **Heap Memory (4GB 중 약 2~3GB 할당)**:
  - Java 17의 G1GC(Garbage Collector)가 어떻게 작동하는지 보세요. 메모리가 톱니바퀴 모양으로 올라갔다 뚝 떨어지는 패턴이 반복되면 정상입니다.

- **Active Service & XLog**:
  - Thread를 200까지 올렸을 때, Scouter 하단의 Active Service 숫자가 급격히 올라가며 줄어들지 않는다면 톰캣의 maxThreads 설정을 검토해야 하는 시점입니다.

- **CPU 사용률 (2 vCPU)**:
  - t3 시리즈는 **부스트 기능(Credit)**이 있습니다. CPU가 80%를 계속 넘어가면 크레딧이 소모되어 나중에 서버가 느려질 수 있으니, 60~70% 선을 유지하는 Thread 수를 찾는 것이 최적의 성능 지점입니다.

## 3. 실습 시나리오: "병목 지점 강제 생성"

단순히 조회만 하면 결과가 너무 깨끗할 수 있습니다. 일부러 부하를 줘서 Scouter의 기능을 체험해 보세요.

- **DB 부하 유도**: 상품 검색 시 LIKE %keyword% 쿼리가 날아가는 API를 JMeter로 찌릅니다.
- **Scouter 확인**: XLog에서 특정 점을 클릭하여 SQL 탭을 봅니다. 어떤 쿼리가 몇 ms 동안 실행되었는지, 인덱스를 안 타서 느린 건지 분석합니다.
- **병목 발견**: 만약 특정 API만 응답 시간이 3000ms(3초)를 넘는다면, JMeter의 Summary Report에서 해당 요청의 Error %가 올라가는지 대조해 봅니다.

## 4. 환경 설정 시 깨알 팁 (t3.medium 특화)

- **Tomcat 메모리 설정**: 4GB RAM이므로, catalina.sh에서 Java 힙 메모리를 -Xms2g -Xmx2g 정도로 넉넉히 잡아주면 Scouter에서 더 안정적인 그래프를 볼 수 있습니다.
- **MySQL 설정**: max_connections를 기본값(보통 151)보다 조금 더 늘려두어야(예: 300) JMeter 200 스레드 테스트 시 DB 연결 오류가 나지 않습니다.

이제 이 설정값으로 JMeter의 'Start' 버튼을 누르고, Scouter의 XLog가 쏟아지는 모습을 관찰해 보세요!