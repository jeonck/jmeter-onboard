# EC2 사양별 부하 테스트 권장 설정

실용적인 부하 테스트를 위해서는 서버의 사양(특히 EC2 t2.micro 같은 프리티어 여부)에 따라 값을 조절해야 합니다. 입문 단계에서 "서버를 죽이지 않으면서 의미 있는 데이터를 뽑아낼 수 있는" 권장 설정값을 안내해 드립니다.

## 1. 단계별 부하 테스트 권장값 (EC2 사양 기준)

보통 학습용 EC2(t2.micro, 1vCPU, 1GB RAM)를 사용 중이라고 가정할 때의 설정입니다.

| 테스트 단계 | Number of Threads (사용자) | Ramp-up Period (준비 시간) | Constant Timer (지연 시간) | 목적 |
|------------|---------------------------|----------------------------|----------------------------|------|
| 1단계: 검증 | 1 ~ 10 | 1초 | 1000ms (1초) | 설정이 정상인지, Scouter에 점이 찍히는지 확인 |
| 2단계: 평시 부하 | 30 ~ 50 | 10 ~ 20초 | 500ms | 일반적인 사용자 접속 상황 모니터링 |
| 3단계: 임계점 찾기 | 100 ~ 200 | 30 ~ 60초 | 300ms | 서버가 언제 느려지는지(TPS 저하) 확인 |

## 2. 주요 파라미터별 설정 가이드

### ① Number of Threads (가상 사용자)
- **권장**: 처음엔 30~50명으로 시작하세요.
- **이유**: 너무 많은 스레드(예: 500명 이상)는 서버보다 내 윈도우 PC의 자원을 먼저 고갈시켜서 테스트 결과가 왜곡될 수 있습니다.

### ② Ramp-up Period (중요!)
- **권장**: Thread 수와 동일하거나 그 이상으로 잡으세요 (예: 50명이면 50초).
- **이유**: 100명을 1초 만에 투입하는 것은 서버에 '폭격'을 가하는 것과 같습니다. 현실적인 서비스는 사용자가 순차적으로 들어오므로, 초당 1~2명씩 증가하도록 설정하는 것이 Scouter에서 그래프 추이를 보기 가장 좋습니다.

### ③ Loop Count (반복 횟수)
- **권장**: 처음엔 Infinite(무한) 보다는 100회~500회 정도 지정을 권장합니다.
- **이유**: 무한 반복 설정 시, 서버가 감당 못 할 정도로 부하가 쌓였을 때 수동으로 멈추기 전까지 EC2가 응답 불능 상태가 되어 강제 재부팅을 해야 할 수도 있습니다.

### ④ Constant Timer (생각 시간, Think Time)
- **권장**: 300ms ~ 1000ms (0.3초 ~ 1초)
- **이유**: 실제 사람은 페이지를 열자마자 0.001초 만에 다음 클릭을 하지 않습니다. 이 값을 너무 작게 주면 서버의 Connection Pool이 순식간에 말라버려 성능 분석이 어려워집니다.

## 3. 실습 시 Scouter 모니터링 포인트

이 값들을 적용하고 Scouter에서 다음을 확인해 보세요.

- **TPS (Transaction Per Second)**: 스레드 수를 늘릴 때 TPS가 같이 올라가다가, 어느 순간 평평해지거나 떨어지면 그곳이 서버의 한계입니다.
- **Heap Memory**: Loop Count를 길게 잡았을 때 메모리 그래프가 우상향하며 내려오지 않는다면 **Memory Leak(메모리 누수)**을 의심할 수 있습니다.
- **XLog**: 점들이 특정 시간대(예: 3초 라인)에 가로로 줄을 서기 시작하면, DB Lock이나 외부 API 연동 지연을 의심해야 합니다.

팁: 만약 EC2 프리티어를 사용 중이라면, CPU Credit이 다 소모되면 서버가 급격히 느려집니다. Scouter에서 CPU 사용량이 90%를 계속 넘는다면 부하를 즉시 줄여주세요!