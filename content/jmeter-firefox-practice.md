# JMeter와 Firefox 연동 레코딩 실습

JMeter와 Firefox를 연동하여 실제 웹 서핑 동작을 스크립트로 만드는 레코딩 실습 가이드를 정리해 드립니다. 이 과정을 마치면 수동으로 블록을 쌓지 않아도 복잡한 시나리오가 자동으로 생성됩니다.

## 1. JMeter 준비 (기록기 설정)

- **템플릿 활용**: File > Templates... > Recording 선택 > Create.
- **기록기 확인**: 좌측 트리 하단의 HTTP(S) Test Script Recorder를 클릭합니다.
- **Port**: 8888 확인.
- **Target Controller**: Test Plan > Thread Group으로 설정 (기록된 블록이 저장될 위치).
- **시작**: 우측 하단의 [Start] 버튼을 누릅니다.
  - 알림창이 뜨면 '확인'을 누르세요. (인증서가 생성되었다는 뜻입니다.)

## 2. Firefox 설정 (통로 연결)

### 프록시 설정:
1. Firefox 설정 > 일반 > 네트워크 설정 > 설정(Settings...) 클릭.
2. 수동 프록시 설정 선택: HTTP 프록시 127.0.0.1, 포트 8888.
3. '모든 프로토콜에 이 프록시 서버 사용' 체크 후 확인.

### 인증서 등록 (HTTPS 대응):
1. Firefox 설정 > 개인 정보 및 보안 > 인증서 보기 > 가져오기(Import...).
2. JMeter 설치 폴더의 bin/ApacheJMeterTemporaryRootCA.crt 선택.
3. '웹사이트 신원을 확인하는 인증 기관' 신뢰 체크 후 확인.

## 3. 실제 레코딩 수행 (동작 기록)

1. **브라우징**: Firefox 주소창에 테스트할 쇼핑몰 주소(EC2 서버 IP:8080)를 입력합니다.
2. **시나리오 진행**:
   - 메인 페이지 접속 -> 로그인 -> 카테고리 클릭 -> 상품 선택 -> 장바구니 담기.
   - Tip: JMeter 화면에 떠 있는 작은 플로팅 바의 Transaction Name에 'Login', 'AddCart' 등을 입력하며 진행하면 나중에 구분하기 좋습니다.
3. **종료**: 동작이 끝났다면 JMeter에서 **[Stop]**을 누릅니다.

## 4. 결과 확인 및 Scouter 모니터링

- **생성된 블록 확인**: JMeter의 Thread Group 아래를 보면 내가 클릭했던 페이지들이 HTTP Request 블록으로 생성되어 있습니다.
- **테스트 실행**:
  - Firefox의 프록시 설정을 '사용 안 함'으로 되돌립니다.
  - JMeter 상단의 초록색 화살표(Start)를 누릅니다.
- **Scouter 관찰**:
  - JMeter가 자동으로 요청을 보내는 동안, Scouter Client에서 XLog가 찍히는지 확인합니다.
  - 어떤 요청(예: 장바구니 담기)에서 점이 높게 찍히는지, 그때 서버의 CPU와 Heap Memory는 어떻게 변하는지 실시간으로 봅니다.

## ⚠️ 실습 시 주의사항 (트러블슈팅)

- **인터넷이 안 돼요**: 레코딩이 끝난 후 Firefox 프록시 설정을 해제하지 않으면 일반 웹사이트 접속이 되지 않습니다. 반드시 '프록시 사용 안 함'으로 복구하세요.
- **기록된 블록이 너무 많아요**: 이미지(.jpg, .png), 폰트, 광고 스크립트 등이 같이 기록된 경우입니다. Recorder의 Requests Filtering 탭에서 Add suggested excludes를 눌러 필터링 설정을 강화한 뒤 다시 기록해 보세요.
- **403/500 에러 발생**: 레코딩된 요청 중에 보안 토큰(CSRF 등)이 포함되어 있다면 단순히 재실행했을 때 서버가 거부할 수 있습니다. 이 경우 변수 처리(Correlation)가 필요합니다.