# JMeter 템플릿 기능 활용

JMeter에서 처음부터 프록시 서버와 레코딩 블록을 일일이 추가하는 건 꽤 번거로운 작업입니다. 그래서 JMeter는 클릭 몇 번으로 레코딩에 필요한 모든 구조를 자동으로 짜주는 'Templates' 기능을 제공합니다.

## 1. 템플릿으로 레코딩 환경 구축하기

- **메뉴 선택**: 상단 툴바의 File > Templates... 를 클릭합니다. (또는 첫 번째 아이콘 클릭)
- **템플릿 선택**: 목록에서 **"Recording"**을 선택하고 [Create] 버튼을 누릅니다.
- **자동 생성 확인**: 좌측 트리에 다음과 같은 요소들이 한꺼번에 생깁니다.
  - HTTP Request Defaults: 서버 IP와 포트를 적는 곳.
  - HTTP Cookie Manager: 세션 유지를 위한 부품.
  - User Defined Variables: 변수 관리.
  - HTTP(S) Test Script Recorder: 실제 프록시 서버 역할을 하는 핵심 블록.

## 2. 레코딩 시작 및 수행 (실습 가이드)

템플릿이 만들어졌다면, 이제 브라우저의 움직임을 기록할 차례입니다.

1. **Recorder 설정**: 좌측 트리 맨 아래 HTTP(S) Test Script Recorder를 클릭합니다.
2. **Start 버튼**: 우측 하단의 [Start] 버튼을 누릅니다.
   - 이때 "Root CA certificate... created"라는 알림창이 뜨는데, 이는 보안 사이트(HTTPS) 기록을 위한 인증서가 만들어졌다는 뜻입니다. (확인 클릭)
3. **브라우저 활동**: 프록시가 설정된 브라우저(Port: 8888)에서 쇼핑몰 메인 -> 로그인 -> 장바구니 순서로 이동합니다.
4. **확인**: JMeter 화면을 보면 Thread Group 아래에 내가 방문한 페이지들이 HTTP Request 블록으로 차곡차곡 쌓이는 것을 볼 수 있습니다.

## 3. 템플릿 레코딩의 숨은 꿀팁

### ① 정적 리소스 필터링 (Exclude)

템플릿으로 만들면 Requests Filtering 탭에 이미 이미지(.png, .js) 등을 제외하는 정규표현식이 들어있을 것입니다. 만약 레코딩 결과에 불필요한 광고나 아이콘 호출이 너무 많다면, 이곳에 필터를 추가해 보세요.

### ② 트랜잭션 이름 지정 (Naming Policy)

레코딩 화면 상단에 'Transaction Name' 입력란이 있습니다.

로그인하기 직전에 여기에 Login_Step이라고 적고 브라우저에서 로그인 버튼을 누르면, 생성되는 블록 이름 앞에 해당 접두사가 붙어 나중에 구분하기 아주 편해집니다.

## 4. 레코딩 후 'Scouter'와 연동하기

레코딩이 끝났다면 **[Stop]**을 누르고, 프록시 설정을 끈 뒤 테스트를 돌려봅니다.

- **JMeter**: 레코딩된 시나리오대로 100명의 부하를 쏩니다.
- **Scouter**: 레코딩된 각 단계(메인, 로그인, 장바구니)가 서버 내부에서 어떤 SQL을 실행하고 CPU를 얼마나 쓰는지 실시간으로 감시합니다.